<div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-06-14T04:59:36.000Z" title="2020-06-14T04:59:36.000Z">2020-06-14</time><span class="level-item"><a class="link-muted" href="/categories/DTM%E3%83%91%E3%82%BD%E3%82%B3%E3%83%B3%E7%9F%A5%E8%AD%98/">DTMパソコン知識</a><span> / </span><a class="link-muted" href="/categories/DTM%E3%83%91%E3%82%BD%E3%82%B3%E3%83%B3%E7%9F%A5%E8%AD%98/mac/">mac</a></span><span class="level-item">9分 既読 (約 1374 箇単語)</span></div></div><h1 class="title is-3 is-size-4-mobile">Catalina と不具合の Mojave 用 kext を使えるようにしてみる</h1><div class="content"><p>macOS Mojave のため構築された一部の Kext ドライバー（カーネル機能拡張ドライバー）は古い KPI で構築され、macOS Catalina とそれ以降の macOS と互換性の問題が生じてしまう：Kext を（<code>kextload</code> 経由）システムに再登録不能。特に「移行アシスタント」で macOS をバックアップから回復・あるいは新しい mac パソコンに移行するたびに、Kext の再登録が必要とされ、故に上記の互換性問題が生じてしまうことになる。</p>
<a id="more"></a>
<h2 id="臨時対応方法"><a href="#臨時対応方法" class="headerlink" title="臨時対応方法"></a>臨時対応方法</h2><p>支障のある Kext がそれぞれの開発元に（Catalina 向けの）更新を行われるまで、根本的な解決策は有りませんが、パソコンずつ設定して使えることができます。</p>
<h3 id="【ステップ１】Kext-のそれぞれのチーム-ID-をメモしておく"><a href="#【ステップ１】Kext-のそれぞれのチーム-ID-をメモしておく" class="headerlink" title="【ステップ１】Kext のそれぞれのチーム ID をメモしておく"></a>【ステップ１】Kext のそれぞれのチーム ID をメモしておく</h3><p>『<a href="https://support.apple.com/ja-jp/HT203001">Mac のシステム情報について</a>』により：</p>
<blockquote>
<p>システム情報を直接開くには、「option」キーを押しながら Apple メニュー  &gt;「システム情報」の順に選択します。</p>
</blockquote>
<p>あるいは Spotlight で <code>System Information.app</code> を実行。</p>
<p>その後、「システム情報」のウィンドウに「ソフトウェア」→「機能拡張」の画面を見て、作動不能な Kext の情報を見て、下記のような項目に注目して、「チーム ID」をメモしておくこと：</p>
<blockquote>
<p><code>Developer ID Application: 開発元の名前 (チーム ID), Developer ID Certification Authority, Apple Root CA</code></p>
</blockquote>
<p>そして、「システム情報」のウィンドウに「ソフトウェア」→「使用停止されたソフトウェア」の画面を見て、ここでのあらゆるすべての項目のタイトルの冒頭には「チーム ID」が記されているから、メモしておくこと。</p>
<p>（ここまでのメモに重複された「チーム ID」は後で一回だけ使って十分。）</p>
<h3 id="【ステップ２】macOS-復元モードでパソコンを再起動"><a href="#【ステップ２】macOS-復元モードでパソコンを再起動" class="headerlink" title="【ステップ２】macOS 復元モードでパソコンを再起動"></a>【ステップ２】macOS 復元モードでパソコンを再起動</h3><p>『<a href="https://support.apple.com/ja-jp/HT201314">macOS 復元について</a>』によって、ステップ４まで行ってください。とりあえず、ユーティリティウインドウが表示されたまで。</p>
<p>その後、メニューバーの「ユーティリティ」メニューで、ターミナルを起動して、下記のコマンドを実行すること。</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spctl kext-consent add 「チーム ID」</span><br></pre></td></tr></table></figure>
<p>例えば Matt Ingalls 氏に署名とアップル公証された Soundflower の Kext を使いたい場合、下記のターミナル指令を実行すると、このチーム ID に関する全ての Kext は使えるようになります（Apple に個別ブロックされた Kext は例外）：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spctl kext-consent add 3G47DU9NXM</span><br></pre></td></tr></table></figure>
<p>複数の「チーム ID」をメモした場合、一つずつを使って上記のターミナル指令を個別実行してください。</p>
<p>全部実行完了したあと、普通のようにパソコンを再起動すること。</p>
<h3 id="【ステップ３】Kext-を分別登録"><a href="#【ステップ３】Kext-を分別登録" class="headerlink" title="【ステップ３】Kext を分別登録"></a>【ステップ３】Kext を分別登録</h3><p>普通のように macOS にログインしたあとの話。</p>
<blockquote>
<p>【注意】上記の手順を実行しなければ、利用者（ユーザー）側だけでブロックされた Kext を使うのはほぼ不可能です。上記の手順を実行完了すると、すぐ使えることでなく、「利用者（ユーザー）側でだけでブロックされた Kext を使うことができる」ことです。<strong>面倒くさいと思えば、別の方法もあります</strong>：『<a href="https://support.apple.com/ja-jp/HT204063">Mac で NVRAM または PRAM をリセットする</a>』に記された手順で NVRAM をリセットして済むことです。</p>
</blockquote>
<p>既にシステムにインストールされた Kext ファイルは下記のターミナル指令で使えるようになるはず（例えば Soundflower）：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo kextload /Library/Extension/Soundflower.kext</span><br></pre></td></tr></table></figure>
<p>あるいは Kext を再インストールしてみること。<br>そのときに、『<a href="https://support.apple.com/ja-jp/guide/mac-help/mh11784/mac">Macの「セキュリティとプライバシー」の「一般」環境設定を変更する</a>』に記された「ブロックされたシステムソフトウェア」の部分の説明によって、Kext を個別「使えるように設定する」ことです。</p>
<h2 id="参考した資料"><a href="#参考した資料" class="headerlink" title="参考した資料"></a>参考した資料</h2><p>『<a href="https://support.apple.com/ja-jp/HT208019">macOS High Sierra のカーネル機能拡張の変更点について準備を進める</a>』の「MDM を使わない場合の User Approved Kernel Extension Loading」その部分。</p>
<p>$ EOF.</p>
</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/macOS/">macOS</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/06/14/20200614-DTM-equip-buying-guide-for-newcomers/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">新人 DTM ミュージシャンの基本装備について</span></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">コメント</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://shiki.puwu.pro/2020/06/14/20200614-macOS-Kext-Gatekeeper-Whitelist/';
            this.page.identifier = '2020/06/14/20200614-macOS-Kext-Gatekeeper-Whitelist/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'shikisuenblog-jp' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div>